<ui:composition template="base.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:p="http://primefaces.org/ui">
	
	<ui:define name="headContent">
		<h:outputStylesheet library="css" name="events.css" />
		
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	</ui:define>


<!-- Body -->
	<ui:define name="content">
		<c:if test="${not empty param['page']}">
			#{eventsBean.setActualPage(param['page'])}
		</c:if>
	
	  	
       <header id="event-header">
            <div class="center-div">
                <h1>Events</h1>
                <h:form class="event-search">
                
                	<h:outputText class="errorLabel" >#{eventsBean.errorMessage}</h:outputText>
                
                    <div class="form-group">
                        <div class="form-row" style="max-width: 950px;">
                            <div class="col-11 offset-xl-0">
                            	<h:inputText class="form-control" type="text" a:placeholder="Search" value="#{eventsBean.searchWord}"/></div>
                            <div class="col-1">
                            	<h:commandLink class="btn btn-primary fa fa-search" type="submit" action="#{eventsBean.search()}"/>
                           	</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="form-row d-xl-flex">
                            <div class="col-auto col-sm-2 col-md-auto col-lg-auto col-xl-auto d-xl-flex">
                                <p class="text-left">From:</p>
                            </div>
                            <div class="col-sm-10 col-md-auto col-lg-auto col-xl-auto d-flex">
                                <h:inputText class="form-control datepicker" value="#{eventsBean.beginDate}"/>
                                </div>
                            <div class="col-sm-2 col-md-auto col-lg-auto col-xl-auto d-xl-flex justify-content-center align-content-center">
                                <p>To:</p>
                            </div>
                            <div class="col-sm-10 col-md-auto col-lg-auto col-xl-auto d-xl-flex">
                            	<h:inputText class="form-control datepicker" value="#{eventsBean.endDate}"/>
                            </div>
                        </div>
                    </div>
                </h:form>
            </div>
        </header>
        
    
             
	  		<h:panelGroup id="divData">

				<c:if test="${eventsBean.hasEvents()}">

				    <div class="card-group-container">
				    	
				    	<c:forEach items="#{eventsBean.getNumberOfRows()}" var="i">
				    	
							 	 <div class="row" data-aos="flip-left" data-aos-duration="1200" data-aos-once="true">
							 	 
								 	<c:forEach items="#{eventsBean.getRow(i)}" var="event">
								 		
								 		<c:if test="#{not empty event}">
								 		
									 		<div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
								                    <div class="card event-card rect-border">
								                  
								                    	<h:graphicImage class="card-img-top w-100 d-block rect-border" value="/resources/files/#{event.getImage(0)}"/>
								                        <div class="card-body">
							                        		
								                            	<h1 class="card-title">#{event.getTitle()}</h1>
								                            
								                            <ul class="list-inline" style="margin: 10px 0 0 0;">
								                                <li class="list-inline-item"><i class="fa fa-map-marker"></i> #{event.getSoonerPlace()}</li>
								                            </ul>
								                            <ul class="list-inline" style="margin: 3px 0 0;">
								                                <li class="list-inline-item"><i class="fa fa-calendar"></i> #{event.getSoonerDate()}</li>
								                                <li class="list-inline-item"><i class="fa fa-thumbs-o-up">	 </i>#{event.getLikes()}</li>
								                            </ul>  
								                            <h:form>
									                            <h:button class="btn btn-primary rect-border" type="button" a:data-bs-hover-animate="pulse" value="Discovery" style="margin: 10px 0 0 -1px;" outcome="event">
									                      	      	<f:param name="id" value="#{event.getId()}" />
									                            </h:button>
								                            </h:form>
							                            </div>
							                             
								                    </div>
								                </div>
							                
							                </c:if>
							                
								 	</c:forEach>
								 	
						 	 	</div>
						 	 	
					 	</c:forEach>
					 	
					</div> 
					
				</c:if>
			
				<c:if test="${not eventsBean.hasEvents()}">
					<h1 class="display-4" style="margin:50px auto 50px auto;width:90%">No Events Found</h1>
				</c:if>
					
			</h:panelGroup>
			
			<h:panelGroup rendered="#{eventsBean.hasEvents()}">
			  	<div class="d-flex pagination-container">
		               <nav>
		                   <ul class="pagination">
			                  
			                   	<h:link>
			                       	<li class="page-item"><a class="page-link" aria-label="Previous"><span aria-hidden="true">«</span></a></li>
		                       </h:link>
		                        <c:forEach var="page" items="#{eventsBean.getPages()}">
		                        		<li class="page-item">
		                        			<h:form>
			                        			<h:commandLink class="page-link" value="#{page}" >
			                        				<f:param name="page" value="#{page}" />
			                        			</h:commandLink>
		                        			</h:form>
			                        	</li>
		                        </c:forEach>
	                    	    <li class="page-item">
		                    	   <a class="page-link" aria-label="Next"><span aria-hidden="true">»</span></a>
                    	    	</li>
		                   </ul>
		               </nav>
		          </div>
			  </h:panelGroup>
			
		<script type="text/javascript">
			
		    //For calendar
		    $(".datepicker").datepicker({
		        inline: true,
		        showWeek: true,
		        firstDay: 1,
		        showAnim: "clip",
	        	dateFormat:"dd/mm/yy",
	        	changeMonth: true,
                changeYear: true
		    });
		
		</script>
	</ui:define>

</ui:composition>
